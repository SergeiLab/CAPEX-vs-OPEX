# F. PRO: CAPEX vs OPEX (–ê—Å—Ç—Ä–∞)
https://official.contest.yandex.ru/contest/79548/problems/F/

## üìÑ –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏

–¶–µ–ª—å ‚Äî –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å IT-–∑–∞–¥–∞—á–∏ –Ω–∞ –¥–≤–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ä–∞—Å—Ö–æ–¥–æ–≤:
- **CAPEX** ‚Äî –∫–∞–ø–∏—Ç–∞–ª—å–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã (—Ä–∞–∑–≤–∏—Ç–∏–µ);
- **OPEX** ‚Äî –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∑–∞—Ç—Ä–∞—Ç—ã (–ø–æ–¥–¥–µ—Ä–∂–∫–∞).

–û—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∑–∞–≤–∏—Å—è—Ç:
- —Ñ–∏–Ω–∞–Ω—Å–æ–≤–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å –∫–æ–º–ø–∞–Ω–∏–∏,  
- –Ω–∞–ª–æ–≥–æ–≤—ã–µ –æ–±—è–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞,  
- —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –±—é–¥–∂–µ—Ç–∞.

---

##  –î–∞–Ω–Ω—ã–µ

–û–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç 1 188 —Å—Ç—Ä–æ–∫, —Ç–µ—Å—Ç–æ–≤–∞—è ‚Äî 255 —Å—Ç—Ä–æ–∫.

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|------|-----------|
| `task_subject` | —Ç–µ–∫—Å—Ç | –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ |
| `work_description` | —Ç–µ–∫—Å—Ç | –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã |
| `hours` | —á–∏—Å–ª–æ | –ß–µ–ª–æ–≤–µ–∫–æ-—á–∞—Å—ã |
| `task_type` | –∫–∞—Ç–µ–≥–æ—Ä–∏—è | –¢–∏–ø –∑–∞–¥–∞—á–∏ (Task, Bug, Story, Epic –∏ –¥—Ä.) |
| `task_status` | –∫–∞—Ç–µ–≥–æ—Ä–∏—è | –°—Ç–∞—Ç—É—Å (DONE, BACKLOG –∏ –¥—Ä.) |
| `target` | –∫–∞—Ç–µ–≥–æ—Ä–∏—è | **–¶–µ–ª–µ–≤–∞—è –º–µ—Ç–∫–∞:** CAPEX –∏–ª–∏ OPEX |

–ú–µ—Ç—Ä–∏–∫–∞: **F1-score (macro)**

---

##  –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|-------------|
| `train.py` / `train.ipynb` | –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ |
| `predict.py` / `predict.ipynb` | –∑–∞–≥—Ä—É–∑–∫–∞ –≤–µ—Å–æ–≤ –∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π |
| `model.pkl` | –æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å |
| `tfidf.pkl` | –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ç–æ—Ä —Ç–µ–∫—Å—Ç–æ–≤ |
| `le_type.pkl`, `le_status.pkl`, `le_target.pkl` | –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ |
| `submission_seed42.csv` | —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π |

---

##  –ü–æ–¥—Ö–æ–¥

1. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö**
   - –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–æ–≤;
   - –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ `task_subject` –∏ `work_description` –≤ –µ–¥–∏–Ω–æ–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ `text`;
   - –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (`LabelEncoder`).

2. **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤**
   - –¢–µ–∫—Å—Ç ‚Üí `TfidfVectorizer(max_features=5000, ngram_range=(1,2))`;
   - –î–æ–±–∞–≤–ª–µ–Ω—ã —á–∏—Å–ª–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏: `hours`, `task_type_enc`, `task_status_enc`.

3. **–ú–æ–¥–µ–ª—å**
   - `RandomForestClassifier(n_estimators=300, max_depth=20, class_weight='balanced')`;
   - –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω `random_state=42` –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏.

4. **–í—ã–≤–æ–¥**
   - –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö;
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ `submission_seed42.csv`.

---

##  –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
```bash
git clone https://github.com/<–≤–∞—à_–ø—Ä–æ—Ñ–∏–ª—å>/capex_opex_classifier.git
cd capex_opex_classifier
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
pip install -r requirements.txt
```

### 3. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
```bash
python train.py
```

### 4. –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```bash
python predict.py
```

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—è–≤–∏—Ç—Å—è —Ñ–∞–π–ª:
```
submission_seed42.csv
```

##  –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

- pandas  
- numpy  
- scikit-learn  
- joblib  

---

##  –ú–µ—Ç—Ä–∏–∫–∞

–ú–æ–¥–µ–ª—å –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è –ø–æ **F1-score (macro)**.  
–î–ª—è –æ—Ü–µ–Ω–∫–∏ –Ω–∞ –∑–∞–∫—Ä—ã—Ç–æ–º —Ç–µ—Å—Ç–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ `public_test`.

---

##  –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å

- –í—Å–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è (`random_state=42`);
- –ü–æ–ª–Ω—ã–π –∫–æ–¥ –æ–±—É—á–µ–Ω–∏—è –∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏;
- –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å `train.py` –∏ `predict.py` –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π.

---

##  –ê–≤—Ç–æ—Ä

**Sergei Lab**  
üí° ‚ÄúAutomating finance, one model at a time.‚Äù
